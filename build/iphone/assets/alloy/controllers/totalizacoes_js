function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){function e(){resetSession(),goTo("seleciona_cliente")}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="totalizacoes",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,t={},l={};i.__views.totalizacoes=Ti.UI.createWindow({backgroundColor:"#ffffff",id:"totalizacoes"}),i.__views.totalizacoes&&i.addTopLevelView(i.__views.totalizacoes),i.__views.__alloyId1475=Ti.UI.createImageView({image:"/images/logo_rodape.jpg",right:"1%",top:"0.8%",id:"__alloyId1475"}),i.__views.totalizacoes.add(i.__views.__alloyId1475),i.__views.logoEmpresa=Ti.UI.createImageView({image:"/images/logo_rodape.jpg",left:"1%",top:"0.8%",id:"logoEmpresa"}),i.__views.totalizacoes.add(i.__views.logoEmpresa),i.__views.__alloyId1476=Ti.UI.createLabel({color:"black",width:"100%",top:"10%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"AGRADECEMOS OS SEUS PEDIDOS ABAIXO RELACIONADOS",id:"__alloyId1476"}),i.__views.totalizacoes.add(i.__views.__alloyId1476),i.__views.corpo=Ti.UI.createView({height:"60%",top:"15%",width:"90%",layout:"vertical",id:"corpo"}),i.__views.totalizacoes.add(i.__views.corpo),i.__views.__alloyId1477=Ti.UI.createView({backgroundColor:"#414143",height:"5%",top:"75%",width:"90%",id:"__alloyId1477"}),i.__views.totalizacoes.add(i.__views.__alloyId1477),i.__views.__alloyId1478=Ti.UI.createLabel({color:"#ffffff",height:"100%",right:"16%",width:"20%",text:"SOMA DOS PEDIDOS",id:"__alloyId1478"}),i.__views.__alloyId1477.add(i.__views.__alloyId1478),i.__views.total=Ti.UI.createLabel({color:"#ffffff",height:"100%",right:"1%",width:"15%",id:"total"}),i.__views.__alloyId1477.add(i.__views.total),i.__views.__alloyId1479=Ti.UI.createView({height:"7%",bottom:"1%",width:"100%",id:"__alloyId1479"}),i.__views.totalizacoes.add(i.__views.__alloyId1479),i.__views.__alloyId1480=Ti.UI.createButton({backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},borderRadius:"5",color:"#ffffff",height:"80%",left:"2%",width:"14%",title:"Voltar Home",id:"__alloyId1480"}),i.__views.__alloyId1479.add(i.__views.__alloyId1480),e?i.__views.__alloyId1480.addEventListener("click",e):l["$.__views.__alloyId1480!click!voltar"]=!0,i.__views.__alloyId1481=Ti.UI.createLabel({color:"black",width:"100%",bottom:"16%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"ESTES PEDIDOS FORAM ENVIADOS PARA OS E-MAILS CADASTRADOS ANTERIORMENTE:",id:"__alloyId1481"}),i.__views.totalizacoes.add(i.__views.__alloyId1481),i.__views.emails=Ti.UI.createLabel({color:"red",width:"100%",bottom:"13%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,id:"emails"}),i.__views.totalizacoes.add(i.__views.emails),t.destroy=function(){},_.extend(i,i.__views),Ti.include("/api/config.js"),Ti.include("/database/aparencia.js"),Ti.include("/database/pedido.js"),Ti.include("/database/carrinho_pedido.js"),Ti.include("/database/email.js"),i.logoEmpresa.image=getImagesFolder()+selectLogoFile();for(var a=0,o=Titanium.UI.createView({backgroundColor:"#414143",height:"20%",layout:"horizontal",width:"100%"}),d=0,r=0,s=consultaPedidoTotalizacao(Ti.App.Properties.getString(SESSION_ID));s.isValidRow();){for(var n=s.fieldByName("ped_id"),c=s.fieldByName("ped_numero"),I=s.fieldByName("cl_cnpj"),p=0,w=consultaCarrinhoTotalizacao(n);w.isValidRow();){var v=w.fieldByName("crp_quantidade"),h=w.fieldByName("crp_preco_unitario"),f=w.fieldByName("crp_ipi"),u=w.fieldByName("desconto_parcela"),y=w.fieldByName("desconto_especial"),g=v*h,T=g*f/100;g+=T;var b=g*u/100;g-=b;var m=g*y/100;g-=m,p+=g,w.next()}d+=p;var E=Titanium.UI.createView({height:"100%",layout:"vertical",width:"33%"}),A=Titanium.UI.createLabel({color:"#ffffff",height:"20%",text:"CNPJ: "+I,width:"100%"});E.add(A);var N=Titanium.UI.createView({height:"80%",width:"100%",layout:"horizontal"}),U=Titanium.UI.createLabel({color:"#ffffff",text:"Pedido NÂº "+c,height:"100%",width:100});N.add(U);var C=Titanium.UI.createLabel({color:"#ff0000",backgroundColor:"#ffffff",text:formatCurrency(p),height:"80%",width:120});N.add(C);var k=Titanium.UI.createImageView({height:"80%",image:"/images/impressora.jpg"});N.add(k);var L=Titanium.UI.createImageView({left:"5%",height:"75%",image:"/images/marca.jpg"});N.add(L),E.add(N),o.add(E),a++,3==a&&(i.corpo.add(o),o=Titanium.UI.createView({backgroundColor:"#414143",width:"100%",height:"20%",layout:"horizontal"})),r++,s.next()}i.corpo.add(o),i.total.text=formatCurrency(d);for(var x="",S=0,R=selectallEmail();R.isValidRow();){var V=R.fieldByName("em_email");0==S?(x=V,S++):x=x+" | "+V,R.next()}i.emails.text=x,l["$.__views.__alloyId1480!click!voltar"]&&i.__views.__alloyId1480.addEventListener("click",e),_.extend(i,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;