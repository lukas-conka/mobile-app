function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(){s.activityIndicator.setMessage("Download de imagens concluido"),goTo("seleciona_cliente")}function t(){s.activityIndicator.setMessage("Download de imagens concluido"),goTo("softwares")}function i(e){var t=e.URL;h[p]=Ti.Network.createHTTPClient({timeout:5e3}),h[p].onerror=function(){h[p]=null,Ti.API.info("Erro ao Baixar Imagem="+t),p++,r()},h[p].onload=function(){n(e.folderName,e.fileName,this.responseData),h[p]=null,r()};try{h[p].open("GET",t),h[p].send()}catch(i){h[p]=null,Ti.API.info("Erro ao Baixar Imagem="+t),p++,r()}}function r(){if(p>0&&null==u[p-1],p<u.length){var r=u[p],n=r.substring(r.lastIndexOf("/")+1);n=n,i({URL:r,fileName:n,folderName:c}),p++,s.activityIndicator.setMessage("Baixando imagem "+p+" de "+d+"...")}else Ti.App.Properties.setString(SYNC,"true"),Ti.App.Properties.setInt(DATABASE_VERSION,SOFTWARE_DB_VERSION),TEST_VERSION?t():e()}function n(e,t,i){var r=Ti.Filesystem.getFile(c,t);r.write(i)}function o(){s.activityIndicator.show()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="baixar_imagens",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var s=this,a={},l={};s.__views.baixar_imagens=Ti.UI.createWindow({backgroundColor:"white",orientationModes:[Ti.UI.LANDSCAPE_LEFT,Ti.UI.LANDSCAPE_RIGHT],id:"baixar_imagens"}),s.__views.baixar_imagens&&s.addTopLevelView(s.__views.baixar_imagens),o?s.__views.baixar_imagens.addEventListener("open",o):l["$.__views.baixar_imagens!open!showIndicator"]=!0,s.__views.activityIndicator=Ti.UI.createActivityIndicator({id:"activityIndicator",message:"Carregando Imagens..."}),s.__views.baixar_imagens.add(s.__views.activityIndicator),a.destroy=function(){},_.extend(s,s.__views),arguments[0]||{},Ti.include("/database/imagens_produtos.js"),Ti.include("/database/aparencia.js"),Ti.include("/api/config.js");for(var c=getImagesFolder(),u=[],d=0,h=[],p=0,f=selectallImagensProdutos();f.isValidRow();){var g=f.fieldByName("img_caminho"),m=g.replace(/ /g,"%20"),y=Ti.Filesystem.getFile(c,m);y.exists()||(d++,u.push(URL_CAMINHO_IMAGENS+m)),f.next()}f.close();for(var v=selectallAparencia();v.isValidRow();){var g=v.fieldByName("apr_arquivo"),m=g.replace(/ /g,"%20"),y=Ti.Filesystem.getFile(c,m);y.exists()||(d++,u.push(URL_CAMINHO_IMAGENS+m)),v.next()}v.close(),r(),l["$.__views.baixar_imagens!open!showIndicator"]&&s.__views.baixar_imagens.addEventListener("open",o),_.extend(s,a)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;