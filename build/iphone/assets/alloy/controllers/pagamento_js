function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){function e(){goTo("replicar")}function i(e){for(var i=e,o=[],a=[],l=[],_=[],d=w.listaclientes.sections[i.sectionIndex],r=d.getItemAt(i.itemIndex),s=r.cliente,n=consultaPrazoPagamento();n.isValidRow();){n.fieldByName("tb_pr_id");var c=n.fieldByName("tb_pr_nome"),I=n.fieldByName("tb_desc_nome"),p=n.fieldByName("tb_desconto_id");o.push(p),a.push(c),l.push(I),_.push(c+" ("+I+"% de desconto)"),n.next()}Titanium.UI.currentWindow;var h=Titanium.UI.createOptionDialog({options:_,destructive:2,cancel:0,title:"Prazo médio"});h.show(),h.addEventListener("click",function(e){t(i,s,o[e.index],a[e.index],l[e.index])})}function t(e,i,t,a,l){for(var _=[],r=[],s=!1,n=consultaDataPagamento(t);n.isValidRow();){s=!0;var c=n.fieldByName("tb_data_id"),I=n.fieldByName("tb_data_nome");r.push(I),_.push(c),n.next()}if(s){Titanium.UI.currentWindow;var p=Titanium.UI.createOptionDialog({options:r,destructive:2,cancel:0,title:"Data"});p.show(),p.addEventListener("click",function(t){o(e,i,a,l,r[t.index])})}else{k[i]=l,U[i]=1,N[i]="Imediato";var h=w.listaclientes.sections[e.sectionIndex],v=h.getItemAt(e.itemIndex);v.label_dias_botao.title=a,v.label_prazo.text=k[i]+"%",v.label_condicao.text=r,h.updateItemAt(e.itemIndex,v),d(e,i)}}function o(e,i,t,o,a){var l=a.split("/");k[i]=o,U[i]=l.length,N[i]=a;var _=w.listaclientes.sections[e.sectionIndex],r=_.getItemAt(e.itemIndex);r.label_dias_botao.title=t,r.label_prazo.text=k[i]+"%",r.label_condicao.text=a,_.updateItemAt(e.itemIndex,r),d(e,i)}function a(e){var i=e,t=[],o=[],a=w.listaclientes.sections[i.sectionIndex],_=a.getItemAt(i.itemIndex),d=_.cliente,r=consultaMaximoDesconto();r.fieldByName("rp_desc_especial");var s=r.fieldByName("rp_limite_desc_especial");for(W=0;s>=W;W++)t.push(W),o.push(W+"%");Titanium.UI.currentWindow;var n=Titanium.UI.createOptionDialog({options:o,destructive:2,cancel:0,title:"Desconto especial"});n.show(),n.addEventListener("click",function(e){l(i,d,t[e.index])})}function l(e,i,t){a[i]=t;var o=w.listaclientes.sections[e.sectionIndex],l=o.getItemAt(e.itemIndex);l.label_especial_botao.title=t+"%",o.updateItemAt(e.itemIndex,l),d(e,i)}function d(e,i){var t=0;t=0!=Y?Y*k[i]/100:S[i]*k[i]/100;var o=0;o=0!=Y?Y-t:S[i]-t;var l=o*a[i]/100,_=o-l,d=0;d=0!=Y?Y/U[i]:S[i]/U[i];var r=_/U[i],s=getClienteCredito(i),n=s.fieldByName("cl_credito_utilizado"),c=s.fieldByName("cl_credito_total"),I=c-n-_,p=w.listaclientes.sections[e.sectionIndex],h=p.getItemAt(e.itemIndex);h.label_parcela.text=U[i]+"x de "+formatCurrency(r),h.label_desconto.text=formatCurrency(_),h.label_credito.text=formatCurrency(I),w.total_geral.text=formatCurrency(_),p.updateItemAt(e.itemIndex,h)}function r(){x="boleto",w.cheque.image="/images/seleciona.png",w.deposito.image="/images/seleciona.png",w.combinar.image="/images/seleciona.png",w.boleto.image="/images/selecionar_vermelho.png"}function s(){x="cheque",w.boleto.image="/images/seleciona.png",w.deposito.image="/images/seleciona.png",w.combinar.image="/images/seleciona.png",w.cheque.image="/images/selecionar_vermelho.png"}function n(){x="deposito",w.boleto.image="/images/seleciona.png",w.cheque.image="/images/seleciona.png",w.combinar.image="/images/seleciona.png",w.deposito.image="/images/selecionar_vermelho.png"}function c(){x="combinar",w.boleto.image="/images/seleciona.png",w.cheque.image="/images/seleciona.png",w.deposito.image="/images/seleciona.png",w.combinar.image="/images/selecionar_vermelho.png"}function I(){goTo("carrinho")}function p(){if(""==x)alert("Forma de pagamento não selecionada");else{for(var e=0,i=new Date,t=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":00",o=0;o<B.length;o++){for(var l=consultaFinalCarrinho(Ti.App.Properties.getString(SESSION_ID),B[o]),_=consultaUltimoPedido(),d=consultaUltimoCarrinhoPedido()+1,r=_+1,s=Ti.App.Properties.getString(CURRENT_USER_ID)+"1"+r,n=0;n<l.length;n++){var c=l[n][0],I=l[n][1],p=l[n][2],w=l[n][3],v=l[n][4],f=l[n][5];l[n][6];var T=l[n][7],u=l[n][8],g=l[n][9],y=d+e;e++,insertCarrinhoPedido(y,Ti.App.Properties.getString(SESSION_ID),c,I,p,w,t,0,k[B[o]],a[B[o]],x,r,B[o],u,T,g,Ti.App.Properties.getString(CURRENT_USER_ID),2)}insertPedido(r,Ti.App.Properties.getString(SESSION_ID),1,N[B[o]],v,f,t,1,s,"","N",B[o],Ti.App.Properties.getString(CURRENT_USER_ID),2)}h(),goTo("finalizacao")}}function h(){resetCarrinho();var e=[],i=[];Ti.App.Properties.setList(SELECTED_CLIENTS,i),Ti.App.Properties.setList(SELECTED_PRODUCTS,e)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="pagamento",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var w=this,v={},f={};w.__views.pagamento=Ti.UI.createWindow({backgroundColor:"white",id:"pagamento"}),w.__views.pagamento&&w.addTopLevelView(w.__views.pagamento),w.__views.__alloyId1073=Ti.UI.createButton({backgroundColor:"#ffffff",color:"#4e8789",top:"2%",title:"PAGAMENTO",id:"__alloyId1073"}),w.__views.pagamento.add(w.__views.__alloyId1073),w.__views.__alloyId1074=Ti.UI.createImageView({image:"/images/logo_rodape.jpg",right:"1%",top:"0.8%",id:"__alloyId1074"}),w.__views.pagamento.add(w.__views.__alloyId1074),w.__views.__alloyId1075=Ti.UI.createView({backgroundColor:"#dbdbdb",bottom:"1%",height:"92%",width:"98%",id:"__alloyId1075"}),w.__views.pagamento.add(w.__views.__alloyId1075),w.__views.__alloyId1076=Ti.UI.createView({height:"7%",top:"2%",width:"98%",id:"__alloyId1076"}),w.__views.__alloyId1075.add(w.__views.__alloyId1076),w.__views.__alloyId1077=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"5%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"13%",text:"CNPJ",id:"__alloyId1077"}),w.__views.__alloyId1076.add(w.__views.__alloyId1077),w.__views.__alloyId1078=Ti.UI.createLabel({backgroundColor:"#69a09d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"0%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",text:"% Sobre Pedido",id:"__alloyId1078"}),w.__views.__alloyId1076.add(w.__views.__alloyId1078),w.__views.__alloyId1079=Ti.UI.createLabel({backgroundColor:"#69a09d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"18%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"7%",text:"Nº Peças",id:"__alloyId1079"}),w.__views.__alloyId1076.add(w.__views.__alloyId1079),w.__views.__alloyId1080=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"25%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"10%",text:"Valor Bruto",id:"__alloyId1080"}),w.__views.__alloyId1076.add(w.__views.__alloyId1080),w.__views.__alloyId1081=Ti.UI.createLabel({backgroundColor:"#69a09d",color:"#ffffff",height:"100%",font:{fontSize:13},left:"35%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",text:"Prazo Médio / Dias",id:"__alloyId1081"}),w.__views.__alloyId1076.add(w.__views.__alloyId1081),w.__views.__alloyId1082=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"40%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",text:"Desc. Prazo Médio",id:"__alloyId1082"}),w.__views.__alloyId1076.add(w.__views.__alloyId1082),w.__views.__alloyId1083=Ti.UI.createLabel({backgroundColor:"#69a09d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"45%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",text:"Desc. Esp.",id:"__alloyId1083"}),w.__views.__alloyId1076.add(w.__views.__alloyId1083),w.__views.__alloyId1084=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"50%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",text:"Desc. Vol.",id:"__alloyId1084"}),w.__views.__alloyId1076.add(w.__views.__alloyId1084),w.__views.__alloyId1085=Ti.UI.createLabel({backgroundColor:"#69a09d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"55%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"11%",text:"Valor Parcela",id:"__alloyId1085"}),w.__views.__alloyId1076.add(w.__views.__alloyId1085),w.__views.__alloyId1086=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"66%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"11%",text:"Valor final do pedido",id:"__alloyId1086"}),w.__views.__alloyId1076.add(w.__views.__alloyId1086),w.__views.__alloyId1087=Ti.UI.createLabel({backgroundColor:"#69a09d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"77%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"11%",text:"Condições de Pagamento",id:"__alloyId1087"}),w.__views.__alloyId1076.add(w.__views.__alloyId1087),w.__views.__alloyId1088=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",left:"88%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"12%",text:"Crédito para Compra",id:"__alloyId1088"}),w.__views.__alloyId1076.add(w.__views.__alloyId1088);var T={},u=[],g={type:"Ti.UI.View",childTemplates:function(){var t=[],o={type:"Ti.UI.View",childTemplates:function(){var i=[],t={type:"Ti.UI.Button",bindId:"label_porcentagem_botao",properties:{backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},color:"#ffffff",font:{fontSize:13},height:"90%",width:"90%",bindId:"label_porcentagem_botao"},events:{click:e}};return i.push(t),i}(),properties:{backgroundColor:"#e1e1e1",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%"}};t.push(o);var l={type:"Ti.UI.Label",bindId:"label_cnpj",properties:{backgroundColor:"#d2d2d2",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"13%",bindId:"label_cnpj"}};t.push(l);var _={type:"Ti.UI.Label",bindId:"label_peca",properties:{backgroundColor:"#e1e1e1",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"7%",bindId:"label_peca"}};t.push(_);var d={type:"Ti.UI.Label",bindId:"label_bruto",properties:{backgroundColor:"#d2d2d2",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"10%",bindId:"label_bruto"}};t.push(d);var r={type:"Ti.UI.View",childTemplates:function(){var e=[],t={type:"Ti.UI.Button",bindId:"label_dias_botao",properties:{backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},color:"#ffffff",font:{fontSize:13},height:"90%",width:"90%",bindId:"label_dias_botao"},events:{click:i}};return e.push(t),e}(),properties:{backgroundColor:"#e1e1e1",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%"}};t.push(r);var s={type:"Ti.UI.Label",bindId:"label_prazo",properties:{backgroundColor:"#d2d2d2",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",bindId:"label_prazo"}};t.push(s);var n={type:"Ti.UI.View",childTemplates:function(){var e=[],i={type:"Ti.UI.Button",bindId:"label_especial_botao",properties:{backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},color:"#ffffff",font:{fontSize:13},height:"90%",width:"90%",bindId:"label_especial_botao"},events:{click:a}};return e.push(i),e}(),properties:{backgroundColor:"#e1e1e1",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%"}};t.push(n);var c={type:"Ti.UI.Label",bindId:"label_volume",properties:{backgroundColor:"#d2d2d2",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"5%",bindId:"label_volume"}};t.push(c);var I={type:"Ti.UI.Label",bindId:"label_parcela",properties:{backgroundColor:"#e1e1e1",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"11%",bindId:"label_parcela"}};t.push(I);var p={type:"Ti.UI.Label",bindId:"label_desconto",properties:{backgroundColor:"#d2d2d2",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"11%",bindId:"label_desconto"}};t.push(p);var h={type:"Ti.UI.Label",bindId:"label_condicao",properties:{backgroundColor:"#e1e1e1",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"11%",bindId:"label_condicao"}};t.push(h);var w={type:"Ti.UI.Label",bindId:"label_credito",properties:{backgroundColor:"#d2d2d2",color:"#000000",font:{fontSize:13},height:"100%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"12%",bindId:"label_credito"}};return t.push(w),t}(),properties:{layout:"horizontal"}};u.push(g);var y={properties:{height:"40",width:"100%",name:"item_cliente"},childTemplates:u};T.item_cliente=y,w.__views.__alloyId1129=Ti.UI.createListSection({id:"__alloyId1129"});var b=[];b.push(w.__views.__alloyId1129),w.__views.listaclientes=Ti.UI.createListView({top:"9%",width:"98%",height:"50%",sections:b,templates:T,id:"listaclientes",defaultItemTemplate:"cliente_lista"}),w.__views.__alloyId1075.add(w.__views.listaclientes),w.__views.__alloyId1132=Ti.UI.createView({backgroundColor:"#20706d",height:"6%",top:"60%",width:"98%",id:"__alloyId1132"}),w.__views.__alloyId1075.add(w.__views.__alloyId1132),w.__views.total_geral=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",right:"1%",width:"6%",text:"R$ 0,00",id:"total_geral"}),w.__views.__alloyId1132.add(w.__views.total_geral),w.__views.__alloyId1133=Ti.UI.createLabel({backgroundColor:"#20706d",color:"#ffffff",font:{fontSize:13},height:"100%",right:"8%",width:"6%",text:"Total Geral:",id:"__alloyId1133"}),w.__views.__alloyId1132.add(w.__views.__alloyId1133),w.__views.__alloyId1134=Ti.UI.createLabel({backgroundColor:"#dbdbdb",color:"#333333",font:{fontSize:17},left:"1%",top:"67%",text:"Observação",id:"__alloyId1134"}),w.__views.__alloyId1075.add(w.__views.__alloyId1134),w.__views.__alloyId1135=Ti.UI.createTextField({backgroundColor:"#ffffff",height:"15%",top:"71%",width:"98%",id:"__alloyId1135"}),w.__views.__alloyId1075.add(w.__views.__alloyId1135),w.__views.__alloyId1136=Ti.UI.createLabel({color:"#008280",left:"1%",top:"87%",text:"Formas de pagamento",id:"__alloyId1136"}),w.__views.__alloyId1075.add(w.__views.__alloyId1136),w.__views.__alloyId1137=Ti.UI.createView({bottom:"1%",height:"8%",layout:"horizontal",width:"98%",id:"__alloyId1137"}),w.__views.__alloyId1075.add(w.__views.__alloyId1137),w.__views.boleto=Ti.UI.createImageView({height:"80%",image:"/images/seleciona.png",id:"boleto"}),w.__views.__alloyId1137.add(w.__views.boleto),r?w.__views.boleto.addEventListener("click",r):f["$.__views.boleto!click!selecionaBoleto"]=!0,w.__views.__alloyId1138=Ti.UI.createLabel({backgroundColor:"#dbdbdb",color:"#000000",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"7%",left:1,text:"Boleto",id:"__alloyId1138"}),w.__views.__alloyId1137.add(w.__views.__alloyId1138),r?w.__views.__alloyId1138.addEventListener("click",r):f["$.__views.__alloyId1138!click!selecionaBoleto"]=!0,w.__views.cheque=Ti.UI.createImageView({height:"86%",image:"/images/seleciona.png",id:"cheque"}),w.__views.__alloyId1137.add(w.__views.cheque),s?w.__views.cheque.addEventListener("click",s):f["$.__views.cheque!click!selecionaCheque"]=!0,w.__views.__alloyId1139=Ti.UI.createLabel({backgroundColor:"#dbdbdb",color:"#000000",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"7%",left:1,text:"Cheque pré",id:"__alloyId1139"}),w.__views.__alloyId1137.add(w.__views.__alloyId1139),s?w.__views.__alloyId1139.addEventListener("click",s):f["$.__views.__alloyId1139!click!selecionaCheque"]=!0,w.__views.deposito=Ti.UI.createImageView({height:"86%",image:"/images/seleciona.png",id:"deposito"}),w.__views.__alloyId1137.add(w.__views.deposito),n?w.__views.deposito.addEventListener("click",n):f["$.__views.deposito!click!selecionaDeposito"]=!0,w.__views.__alloyId1140=Ti.UI.createLabel({backgroundColor:"#dbdbdb",color:"#000000",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"8%",left:1,text:"Depósito",id:"__alloyId1140"}),w.__views.__alloyId1137.add(w.__views.__alloyId1140),n?w.__views.__alloyId1140.addEventListener("click",n):f["$.__views.__alloyId1140!click!selecionaDeposito"]=!0,w.__views.combinar=Ti.UI.createImageView({height:"86%",image:"/images/seleciona.png",id:"combinar"}),w.__views.__alloyId1137.add(w.__views.combinar),c?w.__views.combinar.addEventListener("click",c):f["$.__views.combinar!click!selecionaCombinar"]=!0,w.__views.__alloyId1141=Ti.UI.createLabel({backgroundColor:"#dbdbdb",color:"#000000",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,width:"8%",left:1,text:"À combinar",id:"__alloyId1141"}),w.__views.__alloyId1137.add(w.__views.__alloyId1141),c?w.__views.__alloyId1141.addEventListener("click",c):f["$.__views.__alloyId1141!click!selecionaCombinar"]=!0,w.__views.__alloyId1142=Ti.UI.createLabel({backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},borderRadius:"5",bottom:"1%",color:"#ffffff",font:{fontSize:11},height:"6%",right:"1%",width:"10%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"FINALIZAR PEDIDO",id:"__alloyId1142"}),w.__views.__alloyId1075.add(w.__views.__alloyId1142),p?w.__views.__alloyId1142.addEventListener("click",p):f["$.__views.__alloyId1142!click!finalizaPagamento"]=!0,w.__views.__alloyId1143=Ti.UI.createLabel({backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},borderRadius:"5",bottom:"1%",color:"#ffffff",font:{fontSize:11},height:"6%",right:"12%",width:"20%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"FINALIZAR PEDIDO E ALTERAR MARCA",id:"__alloyId1143"}),w.__views.__alloyId1075.add(w.__views.__alloyId1143),w.__views.__alloyId1144=Ti.UI.createButton({backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},borderRadius:"5",bottom:"1%",color:"#ffffff",font:{fontSize:13},height:"6%",right:"33%",width:"6%",title:"VOLTAR",id:"__alloyId1144"}),w.__views.__alloyId1075.add(w.__views.__alloyId1144),I?w.__views.__alloyId1144.addEventListener("click",I):f["$.__views.__alloyId1144!click!volta"]=!0,v.destroy=function(){},_.extend(w,w.__views),Ti.include("/api/config.js"),Ti.include("/database/clientes.js"),Ti.include("/database/carrinho.js"),Ti.include("/database/carrinho_pedido.js"),Ti.include("/database/prazo_medio.js"),Ti.include("/database/pedido.js"),Ti.include("/database/datas.js"),Ti.include("/database/representante.js");for(var m,E,A=0,N=[],C=[],U=[],a=[],k=[],L=[],x="",S=[],R=0,V=[],D=Ti.App.Properties.getString("valor_desconto_ref"),M=0;7>M;M++)V[M]=100;Ti.App.Properties.getList(SOBRE_PEDIDO)&&(V=Ti.App.Properties.getList(SOBRE_PEDIDO));for(var B=Ti.App.Properties.getList(SELECTED_CLIENTS),M=0;M<B.length;M++){var z=consultaCliente(B[M]);if(z.isValidRow()){var P=z.fieldByName("cl_id"),G=z.fieldByName("cl_cnpj");U[P]=1,E=0,m=0;for(var O=consultaCarrinhoByPagamento(Ti.App.Properties.getString(SESSION_ID),B[M]);O.isValidRow();){var F=O.fieldByName("car_quantidade"),X=O.fieldByName("car_preco_unitario"),$=O.fieldByName("car_ipi"),j=F*X,q=j*$/100;E+=F,m=m+j+q,R+=m,O.next()}if(a[P]=0,k[P]=0,L[P]=0,S[P]=m,0==A){var W=100;A++}else var W=V[M];D>0?(m=D,D=0):m=m,100>W&&(W=0),C.push({cliente:P,template:"item_cliente",label_porcentagem_botao:{title:W+"%"},label_cnpj:{text:G},label_peca:{text:E},label_bruto:{text:formatCurrency(m)},label_dias_botao:{title:"-"},label_prazo:{text:"0%"},label_especial_botao:{title:"0%"},label_volume:{text:"0%"},label_parcela:{text:"-"},label_desconto:{text:"-"},label_condicao:{text:"-"},label_credito:{text:"-"}})}w.total_geral.text=formatCurrency(m)}w.listaclientes.sections[0].setItems(C);var Y=Ti.App.Properties.getString("valor_desconto_ref");Ti.App.Properties.setString("valor_desconto_ref",0),f["$.__views.boleto!click!selecionaBoleto"]&&w.__views.boleto.addEventListener("click",r),f["$.__views.__alloyId1138!click!selecionaBoleto"]&&w.__views.__alloyId1138.addEventListener("click",r),f["$.__views.cheque!click!selecionaCheque"]&&w.__views.cheque.addEventListener("click",s),f["$.__views.__alloyId1139!click!selecionaCheque"]&&w.__views.__alloyId1139.addEventListener("click",s),f["$.__views.deposito!click!selecionaDeposito"]&&w.__views.deposito.addEventListener("click",n),f["$.__views.__alloyId1140!click!selecionaDeposito"]&&w.__views.__alloyId1140.addEventListener("click",n),f["$.__views.combinar!click!selecionaCombinar"]&&w.__views.combinar.addEventListener("click",c),f["$.__views.__alloyId1141!click!selecionaCombinar"]&&w.__views.__alloyId1141.addEventListener("click",c),f["$.__views.__alloyId1142!click!finalizaPagamento"]&&w.__views.__alloyId1142.addEventListener("click",p),f["$.__views.__alloyId1144!click!volta"]&&w.__views.__alloyId1144.addEventListener("click",I),_.extend(w,v)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;