function getTablePedido(){return"tb_pedido"}function dbLoad(){var e=Ti.Database.open(Ti.App.Properties.getString(DATABASE_FILE));return e}function createPedido(){db=dbLoad(),db.execute("CREATE TABLE IF NOT EXISTS "+getTablePedido()+"(\n		id INTEGER PRIMARY KEY, ped_id INTEGER, ped_session_id TEXT, ped_cupom INTEGER, ped_data_pag TEXT, ped_entrega TEXT, ped_entrega_prazo TEXT, ped_data DATE, ped_numero INTEGER, ped_observacao TEXT, ped_status TEXT, fk_cli INTEGER, fk_marcas INTEGER, ep_id INTEGER\n		);"),db.close()}function dropPedido(){db=dbLoad(),db.execute("DROP TABLE IF EXISTS "+getTablePedido()),db.close()}function insertPedido(e,i,t,o,a,l,r,_,d,s,n,c,f,h){db=dbLoad(),db.execute("INSERT INTO "+getTablePedido()+" (\n		ped_id, ped_session_id, ped_cupom, ped_data_pag, ped_entrega, ped_entrega_prazo, ped_data, ped_exportado, ped_numero, ped_observacao, ped_status, fk_cli, fk_marcas, ep_id) \n	VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?)",e,i,t,o,a,l,r,_,d,s,n,c,f,h),db.close()}function selectallPedido(){db=dbLoad();var e=db.execute("SELECT * FROM"+getTablePedido()+"ORDER BY ped_numero DESC");return"android"==Ti.Platform.osname&&db.close(),e}function processPedido(e){dropPedido(),createPedido();for(var i=JSON.parse(e),t=0;t<i.length;t++){var o=i[t].ped_id,a=i[t].ped_session_id,l=i[t].ped_cupom,r=i[t].ped_data_pag,_=i[t].ped_entrega,d=i[t].ped_entrega_prazo,s=i[t].ped_data,n=i[t].ped_numero,c=i[t].ped_observacao,f=i[t].ped_status,h=i[t].fk_cli,p=i[t].fk_marcas,g=i[t].ep_id;insertPedido(o,a,l,r,_,d,s,n,c,f,h,p,g)}}function consultaPedidosBySession(e){db=dbLoad();for(var i=[],t="SELECT ped_id FROM "+getTablePedido()+' WHERE ped_session_id = "'+e+'"',o=db.execute(t);o.isValidRow();)i.push(o.fieldByName("ped_id")),o.next();return"android"==Ti.Platform.osname&&db.close(),i}function consultaPedidos(){db=dbLoad();var e=db.execute("SELECT tb_pedido.*,tb_cliente.cl_razao,tb_cliente.cl_cnpj, tb_pedido.ped_data FROM "+getTablePedido()+" INNER JOIN tb_cliente ON tb_cliente.cl_id = tb_pedido.fk_cli  ORDER BY ped_id DESC");return"android"==Ti.Platform.osname&&db.close(),e}function consultaPedidoTotalizacao(e){db=dbLoad();var i=db.execute("SELECT tb_pedido.ped_id,tb_pedido.ped_numero,tb_cliente.cl_cnpj FROM tb_pedido INNER JOIN tb_cliente ON tb_cliente.cl_id = tb_pedido.fk_cli WHERE tb_pedido.ped_session_id = '"+e+"'");return"android"==Ti.Platform.osname&&db.close(),i}function consultaPedidosPorData(e,i){db=dbLoad();var t="SELECT tb_pedido.*,tb_cliente.cl_razao,tb_cliente.cl_cnpj, tb_pedido.ped_data FROM "+getTablePedido()+" INNER JOIN tb_cliente ON tb_cliente.cl_id = tb_pedido.fk_cli WHERE ped_data BETWEEN '"+e+"' AND '"+i+"'  ORDER BY ped_id DESC";Ti.API.info("query="+t);var o=db.execute(t);return"android"==Ti.Platform.osname&&db.close(),o}function consultaUltimoPedido(){db=dbLoad();var e=db.execute("SELECT "+getTablePedido()+".ped_id,"+getTablePedido()+".ped_id FROM "+getTablePedido()+" ORDER BY "+getTablePedido()+".ped_id DESC LIMIT 1"),i=0;return e.isValidRow()&&(i=e.fieldByName("ped_id")),db.close(),i}