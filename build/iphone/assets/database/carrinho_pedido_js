function getTableCarrinhoPedido(){return"tb_carrinho_pedido"}function dbLoad(){var e=Ti.Database.open(Ti.App.Properties.getString(DATABASE_FILE));return e}function createCarrinhoPedido(){db=dbLoad(),db.execute("CREATE TABLE IF NOT EXISTS "+getTableCarrinhoPedido()+"(\n		id INTEGER PRIMARY KEY, crp_id INTEGER, crp_session_id TEXT, crp_quantidade INTEGER, crp_preco_unitario TEXT, crp_ipi TEXT, crp_icms TEXT, crp_data DATE, desconto TEXT, desconto_parcela TEXT, desconto_especial TEXT, crp_forma_pagamento TEXT, crp_fk_pedido INTEGER, fk_usu INTEGER, fk_tamanhos INTEGER, fk_produtos INTEGER, fk_cores INTEGER, rp_id INTEGER, ep_id INTEGER\n		);"),db.close()}function dropCarrinhoPedido(){db=dbLoad(),db.execute("DROP TABLE IF EXISTS "+getTableCarrinhoPedido()),db.close()}function insertCarrinhoPedido(e,i,t,o,a,l,r,_,d,s,n,c,f,h,y,p,g,I){db=dbLoad(),db.execute("INSERT INTO "+getTableCarrinhoPedido()+"(\n		crp_id, crp_session_id, crp_quantidade, crp_preco_unitario, crp_ipi, crp_icms, crp_data, desconto, desconto_parcela, desconto_especial, crp_forma_pagamento, crp_fk_pedido, fk_usu, fk_tamanhos, fk_produtos, fk_cores, rp_id, ep_id) \n	VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",e,i,t,o,a,l,r,_,d,s,n,c,f,h,y,p,g,I),db.close()}function consultaUltimoCarrinhoPedido(){db=dbLoad();var e=db.execute("SELECT "+getTableCarrinhoPedido()+".crp_id FROM "+getTableCarrinhoPedido()+" ORDER BY "+getTableCarrinhoPedido()+".crp_id DESC LIMIT 1"),i=0;return e.isValidRow()&&(i=e.fieldByName("crp_id")),db.close(),i}function selectallCarrinhoPedido(){db=dbLoad();var e=db.execute("SELECT * FROM "+getTableCarrinhoPedido());return"android"==Ti.Platform.osname&&db.close(),e}function consultaCarrinhoPedidoByPedido(e){db=dbLoad();var i="SELECT tb_carrinho_pedido.crp_quantidade, tb_carrinho_pedido.crp_preco_unitario, tb_carrinho_pedido.crp_ipi, tb_carrinho_pedido.crp_data, tb_carrinho_pedido.desconto, tb_carrinho_pedido.desconto_parcela, tb_carrinho_pedido.desconto_especial, tb_carrinho_pedido.crp_forma_pagamento, tb_carrinho_pedido.fk_tamanhos, tb_carrinho_pedido.fk_produtos, tb_carrinho_pedido.fk_cores, tb_pedido.ped_entrega, tb_pedido.ped_entrega_prazo, tb_pedido.ped_numero, tb_pedido.ped_observacao, tb_pedido.fk_marcas, tb_pedido.ped_data_pag, tb_cliente.cl_cnpj, tb_cliente.cl_razao, tb_cliente.cl_cep_unid, tb_cliente.cl_end_unid, tb_cliente.cl_n_unid, tb_cliente.cl_comp_unid, tb_cliente.cl_bairro_unid, tb_cliente.cl_cidade_unid, tb_cliente.cl_uf_unid, tb_cores.cor_nome, tb_tamanhos.tmh_nome, tb_produtos.prd_nome, tb_produtos.prd_referencia, tb_produtos.prd_ipi, tb_produtos.prd_nome_colecao, tb_produtos.fk_marca,tb_produtos.prd_id, tb_info_produtos.ifp_peso, tb_info_produtos.ifp_cub_a, tb_info_produtos.ifp_cub_l, tb_info_produtos.ifp_cub_p FROM tb_carrinho_pedido INNER JOIN tb_pedido ON tb_pedido.ped_id = "+e+" INNER JOIN tb_cliente ON tb_cliente.cl_id = tb_pedido.fk_cli INNER JOIN tb_cores ON tb_cores.cor_id = tb_carrinho_pedido.fk_cores INNER JOIN tb_tamanhos ON tb_tamanhos.tmh_id = tb_carrinho_pedido.fk_tamanhos INNER JOIN tb_produtos ON tb_produtos.prd_id = tb_carrinho_pedido.fk_produtos INNER JOIN tb_info_produtos ON tb_info_produtos.fk_produtos = tb_carrinho_pedido.fk_produtos AND tb_info_produtos.fk_cores = tb_carrinho_pedido.fk_cores AND tb_info_produtos.fk_tamanhos = tb_carrinho_pedido.fk_tamanhos WHERE tb_carrinho_pedido.crp_fk_pedido = "+e+" ORDER BY tb_carrinho_pedido.fk_produtos;",t=db.execute(i);return"android"==Ti.Platform.osname&&db.close(),t}function consultaCarrinhoTotalizacao(e){db=dbLoad();var e=db.execute("SELECT tb_carrinho_pedido.crp_quantidade,tb_carrinho_pedido.crp_preco_unitario,tb_carrinho_pedido.crp_ipi,tb_carrinho_pedido.desconto_parcela,tb_carrinho_pedido.desconto_especial FROM tb_carrinho_pedido WHERE tb_carrinho_pedido.crp_fk_pedido = "+e);return"android"==Ti.Platform.osname&&db.close(),e}function processCarrinhoPedido(e){dropCarrinhoPedido(),createCarrinhoPedido();for(var i=JSON.parse(e),t=0;t<i.length;t++){var o=i[t].crp_id,a=i[t].crp_session_id,l=i[t].crp_quantidade,r=i[t].crp_preco_unitario,_=i[t].crp_ipi,d=i[t].crp_icms,s=i[t].crp_data,n=i[t].desconto,c=i[t].desconto_parcela,f=i[t].desconto_especial,h=i[t].crp_forma_pagamento,y=i[t].crp_fk_pedido,p=i[t].fk_usu,g=i[t].fk_tamanhos,I=i[t].fk_produtos,w=i[t].fk_cores,u=i[t].rp_id,v=i[t].ep_id;insertCarrinhoPedido(o,a,l,r,_,d,s,n,c,f,h,y,p,g,I,w,u,v)}}