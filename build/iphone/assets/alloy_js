function ucfirst(e){return e?e[0].toUpperCase()+e.substr(1):e}function addNamespace(e){return(CONST.IMPLICIT_NAMESPACES[e]||CONST.NAMESPACE_DEFAULT)+"."+e}function processStyle(e,i,t,o,l){o=o||{},o.classes=t,i.apiName&&(o.apiName=i.apiName),i.id&&(o.id=i.id),i.applyProperties(exports.createStyle(e,o,l))}function isTabletFallback(){return Math.min(Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth)>=700}function deepExtend(){var e,i,t,o,l,a,r=arguments[0]||{},d=1,s=arguments.length,n=!1;for("boolean"==typeof r&&(n=r,r=arguments[1]||{},d=2),"object"==typeof r||_.isFunction(r)||(r={});s>d;d++)if(e=arguments[d],null!=e){"string"==typeof e&&(e=e.split(""));for(i in e)t=r[i],o=e[i],r!==o&&(n&&o&&_.isObject(o)&&((l=_.isArray(o))||!_.has(o,"apiName"))&&(l?(l=!1,a=t&&_.isArray(t)?t:[]):a=_.isDate(o)?new Date(o.valueOf()):t&&_.isObject(t)?t:{},r[i]=deepExtend(n,a,o)),r[i]=o)}return r}var _=require("alloy/underscore")._,Backbone=require("alloy/backbone"),CONST=require("alloy/constants");exports.version="1.6.0",exports._=_,exports.Backbone=Backbone;var DEFAULT_WIDGET="widget",TI_VERSION=Ti.version,MW320_CHECK=!1,IDENTITY_TRANSFORM=void 0,RESET={bottom:null,left:null,right:null,top:null,height:null,width:null,shadowColor:null,shadowOffset:null,backgroundImage:null,backgroundRepeat:null,center:null,layout:null,backgroundSelectedColor:null,backgroundSelectedImage:null,opacity:1,touchEnabled:!0,enabled:!0,horizontalWrap:!0,zIndex:0,backgroundColor:null,font:null,visible:!0,color:null,transform:null,backgroundGradient:{},borderColor:"transparent",borderRadius:0,borderWidth:0};RESET=_.extend(RESET,{backgroundLeftCap:0,backgroundTopCap:0}),exports.M=function(e,i,t){var o,l=(i||{}).config||{},a=l.adapter||{},r={},d={};a.type?(o=require("alloy/sync/"+a.type),r.sync=function(e,i,t){return o.sync(e,i,t)}):r.sync=function(e,i){Ti.API.warn("Execution of "+e+"#sync() function on a model that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(i.toJSON()))},r.defaults=l.defaults,t&&(d.migrations=t),o&&_.isFunction(o.beforeModelCreate)&&(l=o.beforeModelCreate(l,e)||l);var s=Backbone.Model.extend(r,d);return s.prototype.config=l,_.isFunction(i.extendModel)&&(s=i.extendModel(s)||s),o&&_.isFunction(o.afterModelCreate)&&o.afterModelCreate(s,e),s},exports.C=function(e,i,t){var o,l={model:t},a=(t?t.prototype.config:{})||{};a.adapter&&a.adapter.type?(o=require("alloy/sync/"+a.adapter.type),l.sync=function(e,i,t){return o.sync(e,i,t)}):l.sync=function(e,i){Ti.API.warn("Execution of "+e+"#sync() function on a collection that does not support persistence"),Ti.API.warn("model: "+JSON.stringify(i.toJSON()))};var r=Backbone.Collection.extend(l);return r.prototype.config=a,_.isFunction(i.extendCollection)&&(r=i.extendCollection(r)||r),o&&_.isFunction(o.afterCollectionCreate)&&o.afterCollectionCreate(r),r},exports.UI={},exports.UI.create=function(controller,apiName,opts){opts=opts||{};var baseName,ns,parts=apiName.split(".");if(1===parts.length)baseName=apiName,ns=opts.ns||CONST.IMPLICIT_NAMESPACES[baseName]||CONST.NAMESPACE_DEFAULT;else{if(!(parts.length>1))throw"Alloy.UI.create() failed: No API name was given in the second parameter";baseName=parts[parts.length-1],ns=parts.slice(0,parts.length-1).join(".")}opts.apiName=ns+"."+baseName,baseName=baseName[0].toUpperCase()+baseName.substr(1);var style=exports.createStyle(controller,opts);return eval(ns)["create"+baseName](style)},exports.createStyle=function(e,i,t){var o,l;if(!i)return{};o=_.isArray(i.classes)?i.classes.slice(0):_.isString(i.classes)?i.classes.split(/\s+/):[],l=i.apiName,l&&-1===l.indexOf(".")&&(l=addNamespace(l));var a;a=require(e&&_.isObject(e)?"alloy/widgets/"+e.widgetId+"/styles/"+e.name:"alloy/styles/"+e);var r,d,s={};for(r=0,d=a.length;d>r;r++){var n=a[r],c=n.key;if(n.isApi&&-1===c.indexOf(".")&&(c=(CONST.IMPLICIT_NAMESPACES[c]||CONST.NAMESPACE_DEFAULT)+"."+c),n.isId&&i.id&&n.key===i.id||n.isClass&&_.contains(o,n.key));else{if(!n.isApi)continue;if(-1===n.key.indexOf(".")&&(n.key=addNamespace(n.key)),n.key!==l)continue}n.queries&&n.queries.formFactor&&!Alloy[n.queries.formFactor]||deepExtend(!0,s,n.style)}var h=_.omit(i,[CONST.CLASS_PROPERTY,CONST.APINAME_PROPERTY]);return deepExtend(!0,s,h),s[CONST.CLASS_PROPERTY]=o,s[CONST.APINAME_PROPERTY]=l,MW320_CHECK&&delete s[CONST.APINAME_PROPERTY],t?_.defaults(s,t):s},exports.addClass=function(e,i,t,o){if(!t)return void(o&&(MW320_CHECK&&delete o.apiName,i.applyProperties(o)));var l=i[CONST.CLASS_PROPERTY]||[],a=l.length;t=_.isString(t)?t.split(/\s+/):t;var r=_.union(l,t||[]);return a===r.length?void(o&&(MW320_CHECK&&delete o.apiName,i.applyProperties(o))):void processStyle(e,i,r,o)},exports.removeClass=function(e,i,t,o){t=t||[];var l=i[CONST.CLASS_PROPERTY]||[],a=l.length;if(!a||!t.length)return void(o&&(MW320_CHECK&&delete o.apiName,i.applyProperties(o)));t=_.isString(t)?t.split(/\s+/):t;var r=_.difference(l,t);return a===r.length?void(o&&(MW320_CHECK&&delete o.apiName,i.applyProperties(o))):void processStyle(e,i,r,o,RESET)},exports.resetClass=function(e,i,t,o){t=t||[],t=_.isString(t)?t.split(/\s+/):t,processStyle(e,i,t,o,RESET)},exports.createWidget=function(e,i,t){return"undefined"!=typeof i&&null!==i&&_.isObject(i)&&!_.isString(i)&&(t=i,i=DEFAULT_WIDGET),new(require("alloy/widgets/"+e+"/controllers/"+(i||DEFAULT_WIDGET)))(t)},exports.createController=function(e,i){return new(require("alloy/controllers/"+e))(i)},exports.createModel=function(e,i){return new(require("alloy/models/"+ucfirst(e)).Model)(i)},exports.createCollection=function(e,i){return new(require("alloy/models/"+ucfirst(e)).Collection)(i)},exports.isTablet=function(){return"ipad"===Ti.Platform.osname}(),exports.isHandheld=!exports.isTablet,exports.Globals={},exports.Models={},exports.Models.instance=function(e){return exports.Models[e]||(exports.Models[e]=exports.createModel(e))},exports.Collections={},exports.Collections.instance=function(e){return exports.Collections[e]||(exports.Collections[e]=exports.createCollection(e))},exports.CFG=require("alloy/CFG");