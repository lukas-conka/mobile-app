function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){function e(){r.activityIndicator.setMessage("Download de imagens concluido"),goTo("seleciona_cliente")}function i(){r.activityIndicator.setMessage("Download de imagens concluido"),goTo("softwares")}function t(e){var i=e.URL;p[h]=Ti.Network.createHTTPClient({timeout:5e3}),p[h].onerror=function(){p[h]=null,Ti.API.info("Erro ao Baixar Imagem="+i),h++,o()},p[h].onload=function(){a(e.folderName,e.fileName,this.responseData),p[h]=null,o()};try{p[h].open("GET",i),p[h].send()}catch(t){p[h]=null,Ti.API.info("Erro ao Baixar Imagem="+i),h++,o()}}function o(){if(h>0&&null==c[h-1],h<c.length){var o=c[h],a=o.substring(o.lastIndexOf("/")+1);a=a,t({URL:o,fileName:a,folderName:n}),h++,r.activityIndicator.setMessage("Baixando imagem "+h+" de "+f+"...")}else Ti.App.Properties.setString(SYNC,"true"),Ti.App.Properties.setInt(DATABASE_VERSION,SOFTWARE_DB_VERSION),TEST_VERSION?i():e()}function a(e,i,t){var o=Ti.Filesystem.getFile(n,i);o.write(t)}function l(){r.activityIndicator.show()}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="baixar_imagens",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var r=this,d={},s={};r.__views.baixar_imagens=Ti.UI.createWindow({backgroundColor:"white",orientationModes:[Ti.UI.LANDSCAPE_LEFT,Ti.UI.LANDSCAPE_RIGHT],id:"baixar_imagens"}),r.__views.baixar_imagens&&r.addTopLevelView(r.__views.baixar_imagens),l?r.__views.baixar_imagens.addEventListener("open",l):s["$.__views.baixar_imagens!open!showIndicator"]=!0,r.__views.activityIndicator=Ti.UI.createActivityIndicator({id:"activityIndicator",message:"Carregando Imagens..."}),r.__views.baixar_imagens.add(r.__views.activityIndicator),d.destroy=function(){},_.extend(r,r.__views),arguments[0]||{},Ti.include("/database/imagens_produtos.js"),Ti.include("/database/aparencia.js"),Ti.include("/api/config.js");for(var n=getImagesFolder(),c=[],f=0,p=[],h=0,g=selectallImagensProdutos();g.isValidRow();){var I=g.fieldByName("img_caminho"),y=I.replace(/ /g,"%20"),u=Ti.Filesystem.getFile(n,y);u.exists()||(f++,c.push(URL_CAMINHO_IMAGENS+y)),g.next()}g.close();for(var w=selectallAparencia();w.isValidRow();){var I=w.fieldByName("apr_arquivo"),y=I.replace(/ /g,"%20"),u=Ti.Filesystem.getFile(n,y);u.exists()||(f++,c.push(URL_CAMINHO_IMAGENS+y)),w.next()}w.close(),o(),s["$.__views.baixar_imagens!open!showIndicator"]&&r.__views.baixar_imagens.addEventListener("open",l),_.extend(r,d)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;