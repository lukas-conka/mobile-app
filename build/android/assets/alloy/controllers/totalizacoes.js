function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){function e(){resetSession(),goTo("seleciona_cliente")}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="totalizacoes",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,t={},o={};i.__views.totalizacoes=Ti.UI.createWindow({backgroundColor:"#ffffff",id:"totalizacoes"}),i.__views.totalizacoes&&i.addTopLevelView(i.__views.totalizacoes),i.__views.__alloyId1468=Ti.UI.createImageView({image:"/images/logo_rodape.jpg",right:"1%",top:"0.8%",id:"__alloyId1468"}),i.__views.totalizacoes.add(i.__views.__alloyId1468),i.__views.logoEmpresa=Ti.UI.createImageView({image:"/images/logo_rodape.jpg",left:"1%",top:"0.8%",id:"logoEmpresa"}),i.__views.totalizacoes.add(i.__views.logoEmpresa),i.__views.__alloyId1469=Ti.UI.createLabel({color:"black",width:"100%",top:"10%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"AGRADECEMOS OS SEUS PEDIDOS ABAIXO RELACIONADOS",id:"__alloyId1469"}),i.__views.totalizacoes.add(i.__views.__alloyId1469),i.__views.corpo=Ti.UI.createView({height:"60%",top:"15%",width:"90%",layout:"vertical",id:"corpo"}),i.__views.totalizacoes.add(i.__views.corpo),i.__views.__alloyId1470=Ti.UI.createView({backgroundColor:"#414143",height:"5%",top:"75%",width:"90%",id:"__alloyId1470"}),i.__views.totalizacoes.add(i.__views.__alloyId1470),i.__views.__alloyId1471=Ti.UI.createLabel({color:"#ffffff",height:"100%",right:"16%",width:"20%",text:"SOMA DOS PEDIDOS",id:"__alloyId1471"}),i.__views.__alloyId1470.add(i.__views.__alloyId1471),i.__views.total=Ti.UI.createLabel({color:"#ffffff",height:"100%",right:"1%",width:"15%",id:"total"}),i.__views.__alloyId1470.add(i.__views.total),i.__views.__alloyId1472=Ti.UI.createView({height:"7%",bottom:"1%",width:"100%",id:"__alloyId1472"}),i.__views.totalizacoes.add(i.__views.__alloyId1472),i.__views.__alloyId1473=Ti.UI.createButton({backgroundGradient:{type:"linear",colors:["#2c8f8e","#206764"]},borderRadius:"5",color:"#ffffff",height:"80%",left:"2%",width:"14%",title:"Voltar Home",id:"__alloyId1473"}),i.__views.__alloyId1472.add(i.__views.__alloyId1473),e?i.__views.__alloyId1473.addEventListener("click",e):o["$.__views.__alloyId1473!click!voltar"]=!0,i.__views.__alloyId1474=Ti.UI.createLabel({color:"black",width:"100%",bottom:"16%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,text:"ESTES PEDIDOS FORAM ENVIADOS PARA OS E-MAILS CADASTRADOS ANTERIORMENTE:",id:"__alloyId1474"}),i.__views.totalizacoes.add(i.__views.__alloyId1474),i.__views.emails=Ti.UI.createLabel({color:"red",width:"100%",bottom:"13%",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,id:"emails"}),i.__views.totalizacoes.add(i.__views.emails),t.destroy=function(){},_.extend(i,i.__views),Ti.include("/api/config.js"),Ti.include("/database/aparencia.js"),Ti.include("/database/pedido.js"),Ti.include("/database/carrinho_pedido.js"),Ti.include("/database/email.js"),i.logoEmpresa.image=getImagesFolder()+selectLogoFile();for(var a=0,l=Titanium.UI.createView({backgroundColor:"#414143",height:"20%",layout:"horizontal",width:"100%"}),r=0,d=0,s=consultaPedidoTotalizacao(Ti.App.Properties.getString(SESSION_ID));s.isValidRow();){for(var n=s.fieldByName("ped_id"),c=s.fieldByName("ped_numero"),f=s.fieldByName("cl_cnpj"),p=0,I=consultaCarrinhoTotalizacao(n);I.isValidRow();){var h=I.fieldByName("crp_quantidade"),g=I.fieldByName("crp_preco_unitario"),y=I.fieldByName("crp_ipi"),w=I.fieldByName("desconto_parcela"),u=I.fieldByName("desconto_especial"),T=I.fieldByName("desconto_unit"),v=h*g;v-=T;var b=v*y/100;v+=b;var m=v*w/100;v-=m;var E=v*u/100;v-=E,p+=v,I.next()}r+=p;var C=Titanium.UI.createView({height:"100%",layout:"vertical",width:"33%"}),k=Titanium.UI.createLabel({color:"#ffffff",height:"20%",text:"CNPJ: "+f,width:"100%"});C.add(k);var A=Titanium.UI.createView({height:"80%",width:"100%",layout:"horizontal"}),N=Titanium.UI.createLabel({color:"#ffffff",text:"Pedido NÂº "+c,height:"100%",width:100});A.add(N);var U=Titanium.UI.createLabel({color:"#ff0000",backgroundColor:"#ffffff",text:formatCurrency(p),height:"80%",width:120});A.add(U);var L=Titanium.UI.createImageView({height:"80%",image:"/images/impressora.jpg"});A.add(L);var x=Titanium.UI.createImageView({left:"5%",height:"75%",image:"/images/marca.jpg"});A.add(x),C.add(A),l.add(C),a++,3==a&&(i.corpo.add(l),l=Titanium.UI.createView({backgroundColor:"#414143",width:"100%",height:"20%",layout:"horizontal"})),d++,s.next()}i.corpo.add(l),i.total.text=formatCurrency(r);for(var R="",S=0,V=selectallEmail();V.isValidRow();){var D=V.fieldByName("em_email");0==S?(R=D,S++):R=R+" | "+D,V.next()}i.emails.text=R,o["$.__views.__alloyId1473!click!voltar"]&&i.__views.__alloyId1473.addEventListener("click",e),_.extend(i,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;