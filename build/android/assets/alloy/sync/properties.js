function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(e,i,t){var o=i.config.adapter.collection_name?i.config.adapter.collection_name:"default",a=new RegExp("^("+o+")\\-(.+)$"),l=null;if("read"===e)if(i instanceof Backbone.Collection){var r=[];_.each(TAP.listProperties(),function(e){var i=e.match(a);null!==i&&r.push(TAP.getObject(e))}),l=r}else{var d=TAP.getObject(o+"-"+i.id);i.set(d),l=i.toJSON()}else"create"===e||"update"===e?(i.id||(i.id=guid(),i.set(i.idAttribute,i.id)),TAP.setObject(o+"-"+i.id,i.toJSON()||{}),l=i.toJSON()):"delete"===e&&(TAP.removeProperty(o+"-"+i.id),i.clear(),l=i.toJSON());l?(_.isFunction(t.success)&&t.success(l),"read"===e&&i.trigger("fetch")):_.isFunction(t.error)&&t.error(l)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(e){return e=e||{},e.columns=e.columns||{},e.defaults=e.defaults||{},("undefined"==typeof e.columns.id||null===e.columns.id)&&(e.columns.id="String"),e};