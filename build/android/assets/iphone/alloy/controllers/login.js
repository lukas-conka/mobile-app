function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){function e(){if(0==l.loginChave.value.length||0==l.loginUsuario.value.length||0==l.loginSenha.value.length)alert("Favor preencher os dados corretamente");else{l.activityIndicator.show();var e=URL_LOGIN,t=l.loginChave.value,o=l.loginUsuario.value,_=l.loginSenha.value,d={ecatalogos_representante_chave:t,ecatalogos_representante_usuario:o,ecatalogos_representante_senha:_},r=Titanium.Network.createHTTPClient();r.onerror=function(){a()},r.onload=function(){i(this.responseText)};try{r.open("POST",e),r.send(d)}catch(s){a()}}}function i(e){var i=JSON.parse(e),o=i.success;if("true"==o){var a=i.idusuario,_=i.nomecompleto,d=i.emailusuario,r=i.idempresa,s=i.politica,n=i.filename;Ti.App.Properties.setString(LOGIN,"true"),Ti.App.Properties.setString(CURRENT_USER_ID,a),Ti.App.Properties.setString(CURRENT_USER_NAME,_),Ti.App.Properties.setString(CURRENT_USER_EMAIL,d),Ti.App.Properties.setString(CURRENT_EMPRESA,r),Ti.App.Properties.setString(CURRENT_SOFTWARE,s),Ti.App.Properties.setString(SYNC_FILE,n),t()}else l.activityIndicator.hide(),alert("Usuário, chave ou senha inválidos!")}function t(){var e=Alloy.createController("importar").getView();e.open({fullscreen:!0,navBarHidden:!0})}function o(){var e=Alloy.createController("index").getView();e.open({fullscreen:!0,navBarHidden:!0})}function a(){l.activityIndicator.hide(),alert("Falha de comunicação")}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="login",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var l=this,d={},r={};l.__views.login=Ti.UI.createWindow({backgroundColor:"white",id:"login"}),l.__views.login&&l.addTopLevelView(l.__views.login),l.__views.activityIndicator=Ti.UI.createActivityIndicator({id:"activityIndicator",message:"Aguarde..."}),l.__views.login.add(l.__views.activityIndicator),l.__views.mensagem_login=Ti.UI.createImageView({top:"50px",id:"mensagem_login",image:"/images/mensagem_login.jpg"}),l.__views.login.add(l.__views.mensagem_login),l.__views.login_layout=Ti.UI.createView({height:Titanium.UI.SIZE,width:Titanium.UI.SIZE,layout:"horizontal",title:"centered",id:"login_layout"}),l.__views.login.add(l.__views.login_layout),l.__views.loginChave=Ti.UI.createTextField({borderColor:"#6ea9a0",borderRadius:5,color:"black",width:90,height:48,left:10,font:{fontSize:10},id:"loginChave",hintText:"CHAVE"}),l.__views.login_layout.add(l.__views.loginChave),l.__views.loginUsuario=Ti.UI.createTextField({borderColor:"#6ea9a0",borderRadius:5,color:"black",width:90,height:48,left:10,font:{fontSize:10},id:"loginUsuario",hintText:"LOGIN"}),l.__views.login_layout.add(l.__views.loginUsuario),l.__views.loginSenha=Ti.UI.createTextField({borderColor:"#6ea9a0",borderRadius:5,color:"black",width:90,height:48,left:10,font:{fontSize:10},id:"loginSenha",hintText:"SENHA"}),l.__views.login_layout.add(l.__views.loginSenha),l.__views.default_button=Ti.UI.createButton({title:"Ir",id:"default_button"}),l.__views.login_layout.add(l.__views.default_button),e?l.__views.default_button.addEventListener("click",e):r["$.__views.default_button!click!login"]=!0,l.__views.default_button=Ti.UI.createButton({title:"Voltar",id:"default_button"}),l.__views.login_layout.add(l.__views.default_button),o?l.__views.default_button.addEventListener("click",o):r["$.__views.default_button!click!goToIndex"]=!0,d.destroy=function(){},_.extend(l,l.__views),arguments[0]||{},Ti.include("/api/config.js"),l.activityIndicator.hide(),TEST_VERSION&&(l.loginChave.value="1003",l.loginUsuario.value="teste",l.loginSenha.value="123"),r["$.__views.default_button!click!login"]&&l.__views.default_button.addEventListener("click",e),r["$.__views.default_button!click!goToIndex"]&&l.__views.default_button.addEventListener("click",o),_.extend(l,d)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;